{
  "session": "unify-contract-listing-component",
  "description": "Consolidate inconsistent contract listing components into a single reusable component. Currently there are 3 different implementations: ContractsList, LocationsList, and SeoContractsList with separate blade templates that have duplicated code.",
  "tasks": [
    {
      "id": "analyze-listing-components",
      "title": "Analyze existing contract listing components and identify differences",
      "description": "Examine the three contract listing implementations to understand their differences:\n\n1. ContractsList.php / contracts-list.blade.php - Main listing at /\n2. LocationsList.php / locations-list.blade.php - At /paikkakunnat\n3. SeoContractsList.php / seo-contracts-list.blade.php - At /sahkosopimus/omakotitalo, /sahkosopimus/tuulisahko, etc.\n\nFor each, document:\n- What filters/parameters they support\n- How the contract card is rendered\n- What data is passed to the view\n- Visual differences in the card layout\n\nOutput a summary in DECISIONS.md of what's shared vs different between them.\n\nDO NOT make any code changes in this task - just analyze and document.",
      "status": "completed",
      "completed_at": "2026-01-21T00:00:00Z",
      "passes": true,
      "priority": 1
    },
    {
      "id": "create-contract-card-partial",
      "title": "Create a shared contract card Blade partial",
      "description": "Based on the analysis, create a single reusable contract card partial:\n\nFile: laravel/resources/views/components/contract-card.blade.php\n\nThe card should:\n1. Accept a $contract object and optional parameters\n2. Support all the visual elements from the existing cards:\n   - Company logo, contract name, company name\n   - Price info (energia, perusmaksu, vuosikustannus)\n   - Energy source badges (uusiutuva, ydinvoima, fossiilinen)\n   - CO2 emissions badge\n   - Contract type badges (spot/fixed, määräaikainen/toistaiseksi)\n   - Ranking number (optional)\n   - Featured/Suositus badge (optional)\n   - Left border color based on emissions\n3. Be flexible enough for different contexts (with/without ranking, featured state, etc.)\n\nUse @props to define the component interface.",
      "status": "completed",
      "completed_at": "2026-01-21T00:15:00Z",
      "passes": true,
      "priority": 2,
      "depends_on": ["analyze-listing-components"]
    },
    {
      "id": "refactor-contracts-list",
      "title": "Refactor ContractsList to use the shared contract card",
      "description": "Update contracts-list.blade.php to use the new contract-card component instead of inline card markup.\n\n1. Replace the inline card HTML with <x-contract-card :contract=\"$contract\" ... />\n2. Pass required props (rank, featured, consumption, etc.)\n3. Ensure all functionality is preserved\n4. Test the main listing page at / works correctly",
      "status": "completed",
      "completed_at": "2026-01-21T00:20:00Z",
      "passes": true,
      "priority": 3,
      "depends_on": ["create-contract-card-partial"]
    },
    {
      "id": "refactor-seo-contracts-list",
      "title": "Refactor SeoContractsList to use the shared contract card",
      "description": "Update seo-contracts-list.blade.php to use the new contract-card component.\n\n1. Replace the inline card HTML with <x-contract-card :contract=\"$contract\" ... />\n2. Ensure SEO pages at /sahkosopimus/omakotitalo, /sahkosopimus/tuulisahko still work\n3. The filtering logic stays in SeoContractsList.php - only the view changes",
      "status": "completed",
      "completed_at": "2026-01-21T00:25:00Z",
      "passes": true,
      "priority": 4,
      "depends_on": ["refactor-contracts-list"]
    },
    {
      "id": "refactor-locations-list",
      "title": "Refactor LocationsList to use the shared contract card",
      "description": "Update locations-list.blade.php to use the new contract-card component.\n\n1. Replace any inline card HTML with <x-contract-card :contract=\"$contract\" ... />\n2. Ensure /paikkakunnat page works correctly\n3. The location filtering logic stays in LocationsList.php",
      "status": "completed",
      "completed_at": "2026-01-21T00:30:00Z",
      "passes": true,
      "priority": 5,
      "depends_on": ["refactor-seo-contracts-list"]
    },
    {
      "id": "cleanup-and-verify",
      "title": "Clean up duplicated code and verify all pages",
      "description": "Final cleanup:\n\n1. Remove any remaining duplicated card markup\n2. Verify all listing pages render correctly:\n   - / (main listing)\n   - /paikkakunnat\n   - /sahkosopimus/omakotitalo\n   - /sahkosopimus/tuulisahko\n3. Run tests to ensure nothing is broken\n4. Check that the CO2 badges and all visual elements are consistent across all pages",
      "status": "completed",
      "completed_at": "2026-01-21T00:35:00Z",
      "passes": true,
      "priority": 6,
      "depends_on": ["refactor-locations-list"]
    }
  ]
}
